Grammar:
start: (hexdigits|alphanumerics|digits|letters|start) /:\/\//x (letters|digits|whitespaces|alphanumerics|hexdigits|start) | (hexdigits|alphanumerics|digits|letters|start) /:\/\//x (letters|digits|whitespaces|alphanumerics|hexdigits|start) /\//x | /http:\/\//x (letters|digits|whitespaces|alphanumerics|hexdigits|start) /\?/x (letters|digits|whitespaces|alphanumerics|printables|hexdigits|start) | (hexdigits|alphanumerics|digits|letters|start) /:\/\//x (letters|digits|whitespaces|alphanumerics|hexdigits|start) /\?/x (letters|digits|whitespaces|alphanumerics|hexdigits|start) | /http:\/\//x (letters|digits|whitespaces|alphanumerics|hexdigits|start) | /:/x (letters|digits|whitespaces|alphanumerics|hexdigits|start) | (letters|digits|whitespaces|alphanumerics|hexdigits|start) /:/x | (letters|digits|whitespaces|alphanumerics|hexdigits|start) /\#:/x (letters|alphanumerics|printables|digits|hexdigits|punctuations|whitespaces|start) | /http:\/\//x (letters|digits|whitespaces|alphanumerics|hexdigits|start) /\#/x (letters|alphanumerics|printables|digits|hexdigits|punctuations|whitespaces|start) | (letters|digits|whitespaces|alphanumerics|hexdigits|start) | (hexdigits|alphanumerics|digits|letters|start) /:/x (digits|start) | /;/x (letters|digits|whitespaces|alphanumerics|hexdigits|start) /\//x (letters|digits|whitespaces|alphanumerics|hexdigits|start) | /http:/x (letters|digits|punctuations|whitespaces|alphanumerics|hexdigits|start) | /http:\/\//x (letters|digits|whitespaces|alphanumerics|hexdigits|start) /\[/x (letters|digits|whitespaces|alphanumerics|hexdigits|start)
whitespaces: WS
letters: LETTER
digits: INT
hexdigits: HEXDIGIT+
punctuations: /[!"#$%&'()*+,-.\/:;<=>?@[\\]^_`{|}~]/
printables: (LETTER | INT | WS | /[!"#$%&'()*+,-.\/:;<=>?@[\\]^_`{|}~]/)+
alphanumerics: (LETTER | INT)+
%import common.WS

%import common.HEXDIGIT
%import common.LETTER
%import common.LETTER
%import common.INT
%import common.INT
%import common.LETTER
%import common.INT
%import common.WS
!!! Generated an example from grammar: :B1Fe://iY?tR://A
== example passed :) ==
!!! Generated an example from grammar: http://DW
== example passed :) ==
!!! Generated an example from grammar: http:SWu
== example passed :) ==
!!! Generated an example from grammar: ;y/4
== example passed :) ==
!!! Generated an example from grammar: http://FA#lL
== example passed :) ==
!!! Generated an example from grammar: http:Rl
== example passed :) ==
!!! Generated an example from grammar: ;A/B
== example passed :) ==
!!! Generated an example from grammar: ;x/9://k?H
== example passed :) ==
!!! Generated an example from grammar: http://b53e[E3://cZ/:
== example passed :) ==
!!! Generated an example from grammar: http://RPWiMTaVk?90
== example passed :) ==
!!! Generated an example from grammar: D
== example passed :) ==
!!! Generated an example from grammar: 9
== example passed :) ==
!!! Generated an example from grammar: sU://	#: 
== example passed :) ==
!!! Generated an example from grammar: http://eExD?4
== example passed :) ==
!!! Generated an example from grammar: x:9
== example passed :) ==
!!! Generated an example from grammar: 8#:#
== example passed :) ==
!!! Generated an example from grammar: http://
== example passed :) ==
!!! Generated an example from grammar: http://7
== example passed :) ==
!!! Generated an example from grammar: :yk://7d5
== example passed :) ==
!!! Generated an example from grammar: ;5/8
== example passed :) ==
!!! Generated an example from grammar: 3://;a/526/
== example passed :) ==
!!! Generated an example from grammar:  
== example passed :) ==
!!! Generated an example from grammar: http://1[47
== example passed :) ==
!!! Generated an example from grammar: http://3[5#:#$`&
== example passed :) ==
!!! Generated an example from grammar:    	#:pv
== example passed :) ==
!!! Generated an example from grammar: 	:
== example passed :) ==
!!! Generated an example from grammar: http://http://			?BF#  
== example passed :) ==
!!! Generated an example from grammar: http://;;qfI/IK/#EqoiktGb
== example passed :) ==
!!! Generated an example from grammar: http://aov?rc://8/
== example passed :) ==
!!! Generated an example from grammar: http:1:
== example passed :) ==
!!! Generated an example from grammar: ;	/4
== example passed :) ==
!!! Generated an example from grammar: ;O/http://n?	
== example passed :) ==
!!! Generated an example from grammar: Y://V
== example passed :) ==
!!! Generated an example from grammar: http://  
== example passed :) ==
!!! Generated an example from grammar: p:1110
== example passed :) ==
!!! Generated an example from grammar: 4://znc/://ZDG/
== example passed :) ==
!!! Generated an example from grammar: http://dteIF
== example passed :) ==
!!! Generated an example from grammar: V::http://C?W:
== example passed :) ==
!!! Generated an example from grammar: http::
== example passed :) ==
!!! Generated an example from grammar: http:_
== example passed :) ==
!!! Generated an example from grammar: 2z#:5707
== example passed :) ==
!!! Generated an example from grammar: 3:37440://RHrI
== example passed :) ==
!!! Generated an example from grammar: 3F://4
== example passed :) ==
!!! Generated an example from grammar: http://5://F
== example passed :) ==
!!! Generated an example from grammar: pAjg#:M
== example passed :) ==
!!! Generated an example from grammar: http://CI[:Z
== example passed :) ==
!!! Generated an example from grammar: :
== example passed :) ==
!!! Generated an example from grammar: http://lS0[2e
== example passed :) ==
!!! Generated an example from grammar: 3://;D8bEFdc06fE6/Ea/
== example passed :) ==
!!! Generated an example from grammar: 2#:>
== example passed :) ==
!!! Generated an example from grammar: i://w?1
== example passed :) ==
!!! Generated an example from grammar: AFe:87144
== example passed :) ==
!!! Generated an example from grammar: A
== example passed :) ==
!!! Generated an example from grammar: http://k[	
== example passed :) ==
!!! Generated an example from grammar: http://15#	
== example passed :) ==
!!! Generated an example from grammar: http://?f
== example passed :) ==
!!! Generated an example from grammar: 6233://3/
== example passed :) ==
!!! Generated an example from grammar: http::
== example passed :) ==
!!! Generated an example from grammar: Y://pLVHLt
== example passed :) ==
!!! Generated an example from grammar: ;Ce/	
== example passed :) ==
!!! Generated an example from grammar: S#:2
== example passed :) ==
!!! Generated an example from grammar: F://9:2?eV
== example passed :) ==
!!! Generated an example from grammar: :C4
== example passed :) ==
!!! Generated an example from grammar: 2cp://T/
== example passed :) ==
!!! Generated an example from grammar: http://?ea5A
== example passed :) ==
!!! Generated an example from grammar: ;30/ 
== example passed :) ==
!!! Generated an example from grammar: 3:
== example passed :) ==
!!! Generated an example from grammar: http:3M
== example passed :) ==
!!! Generated an example from grammar: :Ujkbw14
== example passed :) ==
!!! Generated an example from grammar: http://tPsR#63://http://WdVDnQ#,?:9
== example passed :) ==
!!! Generated an example from grammar: ;P/0://d?B
== example passed :) ==
!!! Generated an example from grammar: http:a
== example passed :) ==
!!! Generated an example from grammar: http://http://l?A:[F
== example passed :) ==
!!! Generated an example from grammar: http://http://0?o}`4#Y
== example passed :) ==
!!! Generated an example from grammar: a3
== example passed :) ==
!!! Generated an example from grammar: D6c://D
== example passed :) ==
!!! Generated an example from grammar: http://
== example passed :) ==
!!! Generated an example from grammar: C:
== example passed :) ==
!!! Generated an example from grammar: 3
== example passed :) ==
!!! Generated an example from grammar: EwzbV://19
== example passed :) ==
!!! Generated an example from grammar: 2://F/
== example passed :) ==
!!! Generated an example from grammar: http://6aEcB0#pg
== example passed :) ==
!!! Generated an example from grammar: 4#:		
== example passed :) ==
!!! Generated an example from grammar: M
== example passed :) ==
!!! Generated an example from grammar: a2f88://http://	[?H
== example passed :) ==
!!! Generated an example from grammar: ;/RTb
== example passed :) ==
!!! Generated an example from grammar: E:
== example passed :) ==
!!! Generated an example from grammar: http:9Q
== example passed :) ==
!!! Generated an example from grammar: 8:D://Q:
== example passed :) ==
!!! Generated an example from grammar: i1#:QU
== example passed :) ==
!!! Generated an example from grammar: ;/2
== example passed :) ==
!!! Generated an example from grammar: http://9#?
== example passed :) ==
!!! Generated an example from grammar: http://0?d
== example passed :) ==
!!! Generated an example from grammar: http://33
== example passed :) ==
!!! Generated an example from grammar: http://21A
== example passed :) ==
!!! Generated an example from grammar: ;			/http:67
== example passed :) ==
!!! Generated an example from grammar: http://http:739cFE?390
== example passed :) ==
!!! Generated an example from grammar: http://4c?1abf
== example passed :) ==
!!! Generated an example from grammar: pn#:t
== example passed :) ==
!!! Generated an example from grammar: http://W[ 	
== example passed :) ==
input: ftps://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: ftp://host5/?key4=value3&key4=value4
! failed to parse!
input: ftp://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftp://host2/folder?key1=value4&key2=value4
! failed to parse!
input: https://host2/folder
! failed to parse!
input: ftp://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: https://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftp://host4/folder
! failed to parse!
input: ftp://host5/folder?key1=value2&key1=value1
! failed to parse!
input: http://host5/folder?key1=value4
! failed to parse!
input: ftps://host3/folder
! failed to parse!
input: ftps://host2/?key4=value4
! failed to parse!
input: https://host2/folder?key1=value2&key4=value1&key4=value1
! failed to parse!
input: ftp://host5/folder/folder?key4=value2
! failed to parse!
input: http://host4/folder/folder
! failed to parse!
input: ftps://host5/folder
! failed to parse!
input: ftps://host5/folder?key3=value1&key1=value2
! failed to parse!
input: ftps://host3/?key2=value4&key4=value3
! failed to parse!
input: ftp://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: https://host4/folder/folder
! failed to parse!
input: ftps://host4?key1=value3
! failed to parse!
input: http://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: https://host4/folder
! failed to parse!
input: ftps://host4/?key2=value4
! failed to parse!
input: ftp://host2/?key2=value2
! failed to parse!
input: ftps://host4/folder?key1=value3
! failed to parse!
input: ftp://host5/?key4=value3&key3=value2&key1=value1&key2=value4&key2=value2
! failed to parse!
input: ftps://host2/?key2=value3&key1=value3
! failed to parse!
input: ftp://host3/folder
! failed to parse!
input: https://host3/folder
! failed to parse!
input: ftps://host2/folder/
! failed to parse!
input: ftp://host3?key3=value2&key1=value2
! failed to parse!
input: http://host4/folder/folder?key3=value2
! failed to parse!
input: https://host4/folder
! failed to parse!
input: ftp://host2/?key3=value3&key3=value1&key4=value2
! failed to parse!
input: https://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: http://host1/folder/folder/folder/
! failed to parse!
input: ftp://host1/folder/folder/folder?key2=value4
! failed to parse!
input: ftps://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: ftps://host5/folder/folder/
! failed to parse!
input: ftps://host1/folder?key2=value1&key3=value2&key4=value2
! failed to parse!
input: http://host5/folder?key1=value4
! failed to parse!
input: ftp://host5/folder/folder?key3=value4
! failed to parse!
input: ftp://host2/folder?key3=value3&key4=value1
! failed to parse!
input: ftps://host4/folder/folder/folder?key4=value2&key4=value2
! failed to parse!
input: ftps://host2/folder?key1=value1
! failed to parse!
input: ftp://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: https://host3/folder
! failed to parse!
input: https://host3?key3=value2
! failed to parse!
input: ftps://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: ftps://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: ftps://host4/folder
! failed to parse!
input: http://host1/folder
! failed to parse!
input: ftp://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: http://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: http://host4/folder
! failed to parse!
input: https://host2/?key3=value1&key3=value4&key3=value3
! failed to parse!
input: ftp://host2?key3=value2
! failed to parse!
input: ftp://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftp://host5/folder?key4=value4&key1=value2&key1=value1&key4=value2&key4=value3&key2=value3&key4=value2&key1=value4
! failed to parse!
input: http://host2/folder?key3=value4&key4=value4&key3=value1&key2=value4&key4=value3&key2=value1&key4=value1&key2=value3
! failed to parse!
input: https://host2/folder/folder
! failed to parse!
input: http://host1/folder/folder
! failed to parse!
input: https://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: ftps://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: ftp://host4?key2=value4
! failed to parse!
input: ftp://host3/?key1=value3&key2=value3
! failed to parse!
input: https://host4/folder/folder
! failed to parse!
input: https://host1/folder/folder
! failed to parse!
input: ftps://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: https://host2/folder/
! failed to parse!
input: ftps://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: http://host4/folder?key2=value1&key2=value2
! failed to parse!
input: http://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftp://host1/folder?key3=value2
! failed to parse!
input: ftps://host5/folder?key3=value1
! failed to parse!
input: https://host4/folder?key3=value2&key3=value4&key3=value4&key1=value2
! failed to parse!
input: ftp://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: http://host2/folder?key4=value4&key1=value1
! failed to parse!
input: https://host3/?key3=value4&key2=value3&key2=value1&key1=value3
! failed to parse!
input: ftp://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: http://host4/folder/?key4=value2
! failed to parse!
input: ftp://host4/folder/folder?key2=value2
! failed to parse!
input: https://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftp://host3/folder?key3=value1&key4=value2&key4=value4
! failed to parse!
input: http://host4/folder
! failed to parse!
input: http://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: https://host2/folder
! failed to parse!
input: ftp://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: http://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: ftp://host2/folder/folder/folder/folder
! failed to parse!
input: ftps://host1/folder
! failed to parse!
input: http://host1/folder/folder
! failed to parse!
input: ftp://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: ftps://host2/folder?key1=value4
! failed to parse!
input: https://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: https://host4?key4=value2&key2=value1&key4=value1&key3=value2&key2=value2&key3=value3
! failed to parse!
input: ftps://host5/?key3=value2
! failed to parse!
input: ftps://host4/folder
! failed to parse!
input: http://host4/folder/folder
! failed to parse!
input: ftps://host2/folder/folder
! failed to parse!
input: https://host4/folder
! failed to parse!
input: ftps://host2/?key2=value1
! failed to parse!
input: https://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftp://host1/folder
! failed to parse!
input: https://host4?key4=value4&key2=value1&key4=value1&key4=value4&key2=value4
! failed to parse!
input: http://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: ftps://host3/folder?key3=value1&key3=value2&key2=value1
! failed to parse!
input: http://host2/folder
! failed to parse!
input: https://host2/folder
! failed to parse!
input: ftp://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: http://host3/folder
! failed to parse!
input: ftps://host4?key4=value1
! failed to parse!
input: ftp://host5/folder
! failed to parse!
input: ftp://host2/?key2=value3&key4=value4&key2=value1
! failed to parse!
input: https://host1/folder
! failed to parse!
input: ftps://host4/folder?key3=value2
! failed to parse!
input: ftp://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: ftps://host4/folder/folder
! failed to parse!
input: http://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftp://host1?key1=value1&key2=value1
! failed to parse!
input: http://host5?key4=value1&key1=value3&key4=value1&key3=value1&key1=value2&key3=value3
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	1
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	1
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	3
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	4
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	1
                                                                          printables
                                                                            printable	&
                                                                            printables
                                                                              printable	k
                                                                              printables
                                                                                printable	e
                                                                                printables
                                                                                  printable	y
                                                                                  printables
                                                                                    printable	3
                                                                                    printables
                                                                                      printable	=
                                                                                      printables
                                                                                        printable	v
                                                                                        printables
                                                                                          printable	a
                                                                                          printables
                                                                                            printable	l
                                                                                            printables
                                                                                              printable	u
                                                                                              printables
                                                                                                printable	e
                                                                                                printables
                                                                                                  printable	1
                                                                                                  printables
                                                                                                    printable	&
                                                                                                    printables
                                                                                                      printable	k
                                                                                                      printables
                                                                                                        printable	e
                                                                                                        printables
                                                                                                          printable	y
                                                                                                          printables
                                                                                                            printable	1
                                                                                                            printables
                                                                                                              printable	=
                                                                                                              printables
                                                                                                                printable	v
                                                                                                                printables
                                                                                                                  printable	a
                                                                                                                  printables
                                                                                                                    printable	l
                                                                                                                    printables
                                                                                                                      printable	u
                                                                                                                      printables
                                                                                                                        printable	e
                                                                                                                        printables
                                                                                                                          printable	2
                                                                                                                          printables
                                                                                                                            printable	&
                                                                                                                            printables
                                                                                                                              printable	k
                                                                                                                              printables
                                                                                                                                printable	e
                                                                                                                                printables
                                                                                                                                  printable	y
                                                                                                                                  printables
                                                                                                                                    printable	3
                                                                                                                                    printables
                                                                                                                                      printable	=
                                                                                                                                      printables
                                                                                                                                        printable	v
                                                                                                                                        printables
                                                                                                                                          printable	a
                                                                                                                                          printables
                                                                                                                                            printable	l
                                                                                                                                            printables
                                                                                                                                              printable	u
                                                                                                                                              printables
                                                                                                                                                printable	e
                                                                                                                                                printables
                                                                                                                                                  printable	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	1
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	1
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	3
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	4
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	1
                                                                          printables
                                                                            printable	&
                                                                            printables
                                                                              printable	k
                                                                              printables
                                                                                printable	e
                                                                                printables
                                                                                  printable	y
                                                                                  printables
                                                                                    printable	3
                                                                                    printables
                                                                                      printable	=
                                                                                      printables
                                                                                        printable	v
                                                                                        printables
                                                                                          printable	a
                                                                                          printables
                                                                                            printable	l
                                                                                            printables
                                                                                              printable	u
                                                                                              printables
                                                                                                printable	e
                                                                                                printables
                                                                                                  printable	1
                                                                                                  printables
                                                                                                    printable	&
                                                                                                    printables
                                                                                                      printable	k
                                                                                                      printables
                                                                                                        printable	e
                                                                                                        printables
                                                                                                          printable	y
                                                                                                          printables
                                                                                                            printable	1
                                                                                                            printables
                                                                                                              printable	=
                                                                                                              printables
                                                                                                                printable	v
                                                                                                                printables
                                                                                                                  printable	a
                                                                                                                  printables
                                                                                                                    printable	l
                                                                                                                    printables
                                                                                                                      printable	u
                                                                                                                      printables
                                                                                                                        printable	e
                                                                                                                        printables
                                                                                                                          printable	2
                                                                                                                          printables
                                                                                                                            printable	&
                                                                                                                            printables
                                                                                                                              printable	k
                                                                                                                              printables
                                                                                                                                printable	e
                                                                                                                                printables
                                                                                                                                  printable	y
                                                                                                                                  printables
                                                                                                                                    printable	3
                                                                                                                                    printables
                                                                                                                                      printable	=
                                                                                                                                      printables
                                                                                                                                        printable	v
                                                                                                                                        printables
                                                                                                                                          printable	a
                                                                                                                                          printables
                                                                                                                                            printable	l
                                                                                                                                            printables
                                                                                                                                              printable	u
                                                                                                                                              printables
                                                                                                                                                printable	e
                                                                                                                                                printables
                                                                                                                                                  printable	3

input: ftps://host5?key1=value4&key2=value1
! failed to parse!
input: http://host2/folder
! failed to parse!
input: ftp://host4/folder?key3=value3&key4=value3&key2=value3
! failed to parse!
input: http://host4/folder?key1=value2&key2=value3
! failed to parse!
input: http://host4/?key2=value1&key4=value2
! failed to parse!
input: ftps://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftps://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: http://host1/folder/
! failed to parse!
input: ftp://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: ftp://host2/folder?key2=value4&key2=value2
! failed to parse!
input: https://host3/?key1=value3&key2=value2&key4=value1
! failed to parse!
input: ftps://host3/?key1=value4&key4=value1&key1=value1&key2=value1&key1=value1&key3=value4
! failed to parse!
input: https://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftps://host2/folder
! failed to parse!
input: ftp://host4/?key3=value1
! failed to parse!
input: http://host1/folder/?key3=value3&key2=value2&key4=value2&key3=value4
! failed to parse!
input: https://host1/folder
! failed to parse!
input: ftp://host2?key3=value2&key1=value2&key1=value3&key1=value2
! failed to parse!
input: https://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: https://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftp://host1/folder
! failed to parse!
input: https://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: http://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftps://host3/folder/folder
! failed to parse!
input: ftp://host2?key2=value1&key1=value4
! failed to parse!
input: ftp://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftp://host4/folder/folder/folder/folder?key3=value3
! failed to parse!
input: ftps://host1/folder/
! failed to parse!
input: http://host3/folder/folder/folder?key3=value3&key1=value1&key3=value1
! failed to parse!
input: ftp://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: https://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: http://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: http://host1/folder?key1=value2
! failed to parse!
input: ftp://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: http://host5/?key4=value2
! failed to parse!
input: https://host3/?key4=value2
! failed to parse!
input: https://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftps://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: ftps://host3/folder?key4=value1
! failed to parse!
input: ftp://host4/folder
! failed to parse!
input: ftp://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: ftp://host1/?key3=value3
! failed to parse!
input: ftps://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: http://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftps://host1/folder?key3=value4&key2=value2
! failed to parse!
input: ftps://host5/folder?key1=value1&key1=value3&key1=value2
! failed to parse!
input: ftp://host2/?key3=value2&key4=value1&key4=value4
! failed to parse!
input: http://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: ftps://host5?key4=value1&key2=value4&key1=value3&key1=value3&key4=value4
! failed to parse!
input: ftps://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: http://host4/folder/folder
! failed to parse!
input: https://host2/?key2=value3
! failed to parse!
input: ftp://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftps://host3?key2=value2&key2=value1&key4=value3&key2=value2
! failed to parse!
input: https://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: http://host3?key1=value4
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4

input: http://host1/folder/?key4=value2
! failed to parse!
input: ftp://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftp://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: https://host3/?key4=value1&key1=value2&key1=value1
! failed to parse!
input: ftp://host2/folder
! failed to parse!
input: http://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftps://host2?key4=value2
! failed to parse!
input: https://host3/folder/folder?key2=value4
! failed to parse!
input: http://host4/folder?key2=value4&key3=value1
! failed to parse!
input: http://host4?key1=value2
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2

input: http://host1/?key4=value1&key2=value3&key3=value4
! failed to parse!
input: https://host2?key1=value3&key2=value2&key2=value2&key2=value2&key4=value3&key4=value1
! failed to parse!
input: ftps://host1/folder/
! failed to parse!
input: https://host5?key2=value2
! failed to parse!
input: http://host2/folder
! failed to parse!
input: https://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftp://host2/?key1=value3
! failed to parse!
input: http://host3/folder
! failed to parse!
input: ftps://host3/folder/folder?key4=value2&key1=value3&key4=value4&key4=value2
! failed to parse!
input: ftps://host1/folder/
! failed to parse!
input: ftps://host5/folder/folder
! failed to parse!
input: https://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftps://host3/?key1=value3
! failed to parse!
input: ftp://host2?key1=value3&key1=value3&key2=value3
! failed to parse!
input: https://host2?key2=value3
! failed to parse!
input: ftp://host1/?key2=value2
! failed to parse!
input: https://host4/folder/
! failed to parse!
input: ftp://host3/folder?key2=value1&key2=value2
! failed to parse!
input: ftps://host5/folder/
! failed to parse!
input: ftps://host2/folder/folder/folder?key3=value3
! failed to parse!
input: ftps://host2?key3=value1
! failed to parse!
input: https://host1/folder/folder
! failed to parse!
input: ftp://host2/folder/
! failed to parse!
input: ftp://host1/folder/?key1=value4
! failed to parse!
input: http://host3/folder/folder
! failed to parse!
input: http://host4/folder?key4=value1
! failed to parse!
input: http://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: https://host2/folder/folder/?key4=value4&key2=value4
! failed to parse!
input: ftp://host2/folder/folder?key4=value4
! failed to parse!
input: ftp://host2/folder?key1=value2&key3=value3
! failed to parse!
input: ftp://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: https://host4/folder
! failed to parse!
input: https://host5/folder/
! failed to parse!
input: http://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: ftp://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: ftps://host5/folder/folder/?key2=value4
! failed to parse!
input: ftps://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: https://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftp://host4/?key4=value1&key2=value2&key1=value4&key2=value2
! failed to parse!
input: ftps://host2/folder
! failed to parse!
input: http://host4/folder
! failed to parse!
input: https://host2/folder?key3=value3
! failed to parse!
input: ftps://host4/folder?key1=value1
! failed to parse!
input: ftp://host1?key4=value3
! failed to parse!
input: http://host4/folder/folder/
! failed to parse!
input: ftp://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftp://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftps://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftp://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: https://host4/folder
! failed to parse!
input: ftps://host5/?key4=value4&key3=value2&key4=value1&key4=value1
! failed to parse!
input: https://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: https://host3?key3=value1
! failed to parse!
input: ftps://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftp://host3/folder/folder?key3=value4&key1=value2&key1=value4&key3=value4
! failed to parse!
input: ftp://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: https://host4/folder/folder/
! failed to parse!
input: http://host2/folder/?key1=value1&key1=value4&key4=value3&key3=value1
! failed to parse!
input: ftp://host4/folder?key3=value4&key3=value3
! failed to parse!
input: ftp://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftps://host2?key1=value3&key3=value1&key1=value3&key1=value2
! failed to parse!
input: https://host2?key3=value2
! failed to parse!
input: ftp://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: http://host2?key4=value4
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4

input: http://host4/folder
! failed to parse!
input: http://host4/folder?key1=value3
! failed to parse!
input: https://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: http://host5?key3=value3
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3

input: http://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: http://host5/?key2=value3&key3=value1
! failed to parse!
input: ftp://host1/?key2=value3&key1=value2&key4=value3
! failed to parse!
input: https://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: https://host5/folder
! failed to parse!
input: http://host1/folder/folder?key1=value4&key1=value3&key1=value4&key2=value1
! failed to parse!
input: https://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftp://host3/?key1=value4&key4=value2
! failed to parse!
input: ftp://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftps://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftps://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: http://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftp://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: ftps://host2/?key4=value3&key2=value3&key1=value2&key1=value2
! failed to parse!
input: ftp://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: ftp://host4/folder
! failed to parse!
input: ftp://host2/folder?key2=value1&key2=value3&key3=value3&key3=value4
! failed to parse!
input: ftps://host4/?key2=value3
! failed to parse!
input: http://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: https://host2?key4=value3&key3=value2
! failed to parse!
input: http://host4?key4=value1&key3=value1
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	1
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	3
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	1
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	3
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	1

input: ftps://host5/folder?key4=value1
! failed to parse!
input: https://host1/folder?key4=value4
! failed to parse!
input: ftp://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: http://host4/folder
! failed to parse!
input: https://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: ftps://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: https://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: http://host3/folder/
! failed to parse!
input: http://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: https://host4/folder?key4=value4
! failed to parse!
input: https://host3/?key2=value2
! failed to parse!
input: https://host3/folder
! failed to parse!
input: https://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftp://host1/folder
! failed to parse!
input: https://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftps://host2/folder
! failed to parse!
input: https://host4/?key4=value3&key2=value1
! failed to parse!
input: ftp://host3/folder
! failed to parse!
input: ftps://host5/folder/?key3=value1
! failed to parse!
input: ftp://host1/folder/folder?key2=value2&key2=value2
! failed to parse!
input: ftp://host4/folder?key4=value3&key2=value1
! failed to parse!
input: ftps://host5?key4=value1
! failed to parse!
input: ftps://host4/folder/folder?key1=value3&key1=value4&key2=value1&key3=value1&key1=value2&key3=value4
! failed to parse!
input: https://host1/?key4=value2
! failed to parse!
input: https://host1/folder
! failed to parse!
input: ftps://host2/folder?key1=value3
! failed to parse!
input: http://host1?key2=value2&key1=value1&key3=value4
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	1
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	1
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	3
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	4
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	1
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	1
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	3
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	4

input: ftp://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: https://host3/folder
! failed to parse!
input: ftps://host3?key1=value1
! failed to parse!
input: https://host3/folder
! failed to parse!
input: ftp://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftp://host2?key3=value3&key2=value3
! failed to parse!
input: ftps://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: ftps://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: ftps://host1?key2=value2
! failed to parse!
input: ftp://host2/folder/?key3=value1
! failed to parse!
input: https://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftp://host1/folder/folder
! failed to parse!
input: ftp://host2?key2=value1&key3=value1
! failed to parse!
input: ftp://host5/folder
! failed to parse!
input: http://host1/folder
! failed to parse!
input: https://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: https://host5/?key4=value1&key3=value4&key2=value3&key4=value2
! failed to parse!
input: ftp://host4?key1=value3&key2=value4&key2=value4
! failed to parse!
input: http://host4/?key4=value1&key3=value2&key3=value3
! failed to parse!
input: ftps://host5/folder
! failed to parse!
input: ftps://host5/folder?key1=value2&key2=value4&key1=value3&key2=value3&key3=value2&key2=value3&key3=value1
! failed to parse!
input: http://host5/folder/folder/folder/folder
! failed to parse!
input: ftps://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: http://host3/folder
! failed to parse!
input: http://host5?key3=value3&key2=value2&key1=value1&key2=value1&key3=value1&key2=value4
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	2
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	2
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	1
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	1
                                                                          printables
                                                                            printable	&
                                                                            printables
                                                                              printable	k
                                                                              printables
                                                                                printable	e
                                                                                printables
                                                                                  printable	y
                                                                                  printables
                                                                                    printable	2
                                                                                    printables
                                                                                      printable	=
                                                                                      printables
                                                                                        printable	v
                                                                                        printables
                                                                                          printable	a
                                                                                          printables
                                                                                            printable	l
                                                                                            printables
                                                                                              printable	u
                                                                                              printables
                                                                                                printable	e
                                                                                                printables
                                                                                                  printable	1
                                                                                                  printables
                                                                                                    printable	&
                                                                                                    printables
                                                                                                      printable	k
                                                                                                      printables
                                                                                                        printable	e
                                                                                                        printables
                                                                                                          printable	y
                                                                                                          printables
                                                                                                            printable	3
                                                                                                            printables
                                                                                                              printable	=
                                                                                                              printables
                                                                                                                printable	v
                                                                                                                printables
                                                                                                                  printable	a
                                                                                                                  printables
                                                                                                                    printable	l
                                                                                                                    printables
                                                                                                                      printable	u
                                                                                                                      printables
                                                                                                                        printable	e
                                                                                                                        printables
                                                                                                                          printable	1
                                                                                                                          printables
                                                                                                                            printable	&
                                                                                                                            printables
                                                                                                                              printable	k
                                                                                                                              printables
                                                                                                                                printable	e
                                                                                                                                printables
                                                                                                                                  printable	y
                                                                                                                                  printables
                                                                                                                                    printable	2
                                                                                                                                    printables
                                                                                                                                      printable	=
                                                                                                                                      printables
                                                                                                                                        printable	v
                                                                                                                                        printables
                                                                                                                                          printable	a
                                                                                                                                          printables
                                                                                                                                            printable	l
                                                                                                                                            printables
                                                                                                                                              printable	u
                                                                                                                                              printables
                                                                                                                                                printable	e
                                                                                                                                                printables
                                                                                                                                                  printable	4
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	2
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	2
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	1
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	1
                                                                          printables
                                                                            printable	&
                                                                            printables
                                                                              printable	k
                                                                              printables
                                                                                printable	e
                                                                                printables
                                                                                  printable	y
                                                                                  printables
                                                                                    printable	2
                                                                                    printables
                                                                                      printable	=
                                                                                      printables
                                                                                        printable	v
                                                                                        printables
                                                                                          printable	a
                                                                                          printables
                                                                                            printable	l
                                                                                            printables
                                                                                              printable	u
                                                                                              printables
                                                                                                printable	e
                                                                                                printables
                                                                                                  printable	1
                                                                                                  printables
                                                                                                    printable	&
                                                                                                    printables
                                                                                                      printable	k
                                                                                                      printables
                                                                                                        printable	e
                                                                                                        printables
                                                                                                          printable	y
                                                                                                          printables
                                                                                                            printable	3
                                                                                                            printables
                                                                                                              printable	=
                                                                                                              printables
                                                                                                                printable	v
                                                                                                                printables
                                                                                                                  printable	a
                                                                                                                  printables
                                                                                                                    printable	l
                                                                                                                    printables
                                                                                                                      printable	u
                                                                                                                      printables
                                                                                                                        printable	e
                                                                                                                        printables
                                                                                                                          printable	1
                                                                                                                          printables
                                                                                                                            printable	&
                                                                                                                            printables
                                                                                                                              printable	k
                                                                                                                              printables
                                                                                                                                printable	e
                                                                                                                                printables
                                                                                                                                  printable	y
                                                                                                                                  printables
                                                                                                                                    printable	2
                                                                                                                                    printables
                                                                                                                                      printable	=
                                                                                                                                      printables
                                                                                                                                        printable	v
                                                                                                                                        printables
                                                                                                                                          printable	a
                                                                                                                                          printables
                                                                                                                                            printable	l
                                                                                                                                            printables
                                                                                                                                              printable	u
                                                                                                                                              printables
                                                                                                                                                printable	e
                                                                                                                                                printables
                                                                                                                                                  printable	4

input: ftps://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftps://host4/folder
! failed to parse!
input: ftps://host3/?key3=value2
! failed to parse!
input: https://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftps://host1/folder?key4=value4&key4=value2&key1=value2
! failed to parse!
input: ftps://host5/folder?key1=value3&key2=value2&key1=value1&key1=value2
! failed to parse!
input: ftps://host2/folder
! failed to parse!
input: http://host4/folder/folder?key2=value2&key4=value3&key1=value2&key1=value4
! failed to parse!
input: https://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: https://host1?key2=value4&key1=value4&key2=value1
! failed to parse!
input: ftps://host2/folder/?key1=value1
! failed to parse!
input: ftps://host2/folder/?key1=value2
! failed to parse!
input: ftps://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftp://host2/folder?key3=value4&key3=value1&key3=value2&key1=value1
! failed to parse!
input: http://host5/folder
! failed to parse!
input: https://host5?key2=value3&key2=value1&key1=value1
! failed to parse!
input: https://host4/folder/folder/folder?key4=value2
! failed to parse!
input: https://host5?key3=value1&key4=value1
! failed to parse!
input: http://host1?key2=value4
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4

input: ftps://host5/folder
! failed to parse!
input: ftps://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: https://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftp://host3/folder/?key2=value4&key2=value2
! failed to parse!
input: ftp://host4/folder
! failed to parse!
input: http://host3/?key2=value3&key2=value2&key2=value1&key2=value4
! failed to parse!
input: ftp://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftps://host3/folder
! failed to parse!
input: ftps://host5/folder
! failed to parse!
input: https://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftp://host2/folder?key4=value4&key1=value2
! failed to parse!
input: ftps://host3?key4=value2
! failed to parse!
input: http://host5/folder/folder
! failed to parse!
input: ftp://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: http://host5/folder/folder?key2=value2&key3=value3&key4=value1&key1=value2&key3=value2
! failed to parse!
input: ftp://host5/?key1=value1
! failed to parse!
input: http://host3/folder/folder
! failed to parse!
input: http://host4/folder?key1=value3&key1=value1&key1=value1
! failed to parse!
input: http://host3/folder/
! failed to parse!
input: ftp://host1/folder?key2=value2&key3=value1&key2=value3&key2=value1
! failed to parse!
input: ftps://host1/?key1=value2&key4=value3&key1=value1
! failed to parse!
input: https://host3?key1=value4&key2=value2&key1=value4
! failed to parse!
input: https://host2?key3=value1&key3=value4&key1=value4&key4=value1
! failed to parse!
input: https://host5/folder/folder
! failed to parse!
input: https://host4/?key4=value4
! failed to parse!
input: https://host4/folder?key2=value1&key2=value3
! failed to parse!
input: ftps://host2/?key4=value2&key2=value3&key2=value2&key2=value4
! failed to parse!
input: ftp://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftp://host1/folder
! failed to parse!
input: http://host3/folder
! failed to parse!
input: ftps://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: https://host5?key3=value4&key4=value2
! failed to parse!
input: ftps://host3/?key4=value4&key2=value2&key3=value2&key2=value4&key1=value4
! failed to parse!
input: ftp://host3/folder/folder
! failed to parse!
input: ftps://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: ftps://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: https://host3?key2=value2&key4=value1
! failed to parse!
input: ftp://host4/?key3=value1&key4=value4&key3=value2
! failed to parse!
input: https://host2/?key3=value3
! failed to parse!
input: http://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: https://host1/folder?key2=value3
! failed to parse!
input: ftps://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: https://host1/folder?key1=value2
! failed to parse!
input: https://host5?key1=value4
! failed to parse!
input: ftp://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: http://host2?key3=value3
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3

input: ftps://host5/folder
! failed to parse!
input: ftp://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftps://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: http://host5?key4=value2
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2

input: http://host2/folder/
! failed to parse!
input: https://host1/folder/folder/folder?key1=value4&key1=value2&key4=value2
! failed to parse!
input: ftps://host3/folder
! failed to parse!
input: ftps://host5?key3=value4
! failed to parse!
input: ftp://host3/folder
! failed to parse!
input: https://host3/folder/?key1=value4&key1=value3&key4=value1&key2=value4&key4=value3&key4=value2
! failed to parse!
input: http://host5/folder/folder/?key1=value4&key1=value1
! failed to parse!
input: ftps://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftps://host3/?key4=value3&key1=value2&key4=value3
! failed to parse!
input: https://host1/folder?key1=value4
! failed to parse!
input: http://host1/folder
! failed to parse!
input: https://host1/folder/folder/folder/folder
! failed to parse!
input: ftps://host1/folder/?key3=value2&key1=value3
! failed to parse!
input: https://host2?key3=value4
! failed to parse!
input: ftp://host2/?key2=value4
! failed to parse!
input: ftp://host1/?key3=value2&key1=value4
! failed to parse!
input: http://host4/folder?key1=value1&key2=value1
! failed to parse!
input: ftp://host4/?key3=value3&key4=value1&key2=value3&key2=value2&key1=value3&key3=value3
! failed to parse!
input: ftp://host1/folder/folder/?key4=value4
! failed to parse!
input: ftps://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftps://host3/folder?key1=value3
! failed to parse!
input: ftps://host3?key2=value4
! failed to parse!
input: ftp://host5/folder/?key2=value3
! failed to parse!
input: ftp://host5/folder/folder/folder?key4=value4
! failed to parse!
input: https://host4/?key1=value2&key3=value2
! failed to parse!
input: http://host5/folder/folder?key4=value2&key3=value3&key4=value3
! failed to parse!
input: http://host2/folder?key3=value3
! failed to parse!
input: ftp://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: https://host4/folder
! failed to parse!
input: ftps://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: http://host3/folder
! failed to parse!
input: http://host3?key1=value3
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3

input: https://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: https://host2/folder
! failed to parse!
input: ftps://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: http://host3?key3=value3&key4=value4&key2=value1
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	4
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	4
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	2
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	4
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	4
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	2
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	1

input: ftps://host4/folder
! failed to parse!
input: https://host2?key1=value3
! failed to parse!
input: ftps://host5/folder/
! failed to parse!
input: http://host5/folder/folder
! failed to parse!
input: http://host5?key3=value2&key3=value3&key1=value2&key1=value1
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	3
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	3
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	1
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	2
                                                                          printables
                                                                            printable	&
                                                                            printables
                                                                              printable	k
                                                                              printables
                                                                                printable	e
                                                                                printables
                                                                                  printable	y
                                                                                  printables
                                                                                    printable	1
                                                                                    printables
                                                                                      printable	=
                                                                                      printables
                                                                                        printable	v
                                                                                        printables
                                                                                          printable	a
                                                                                          printables
                                                                                            printable	l
                                                                                            printables
                                                                                              printable	u
                                                                                              printables
                                                                                                printable	e
                                                                                                printables
                                                                                                  printable	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	3
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	3
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	1
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	2
                                                                          printables
                                                                            printable	&
                                                                            printables
                                                                              printable	k
                                                                              printables
                                                                                printable	e
                                                                                printables
                                                                                  printable	y
                                                                                  printables
                                                                                    printable	1
                                                                                    printables
                                                                                      printable	=
                                                                                      printables
                                                                                        printable	v
                                                                                        printables
                                                                                          printable	a
                                                                                          printables
                                                                                            printable	l
                                                                                            printables
                                                                                              printable	u
                                                                                              printables
                                                                                                printable	e
                                                                                                printables
                                                                                                  printable	1

input: ftp://host3/folder/folder/folder
! failed to parse!
input: https://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: http://host1/?key4=value2&key1=value2&key1=value2&key3=value2&key3=value3
! failed to parse!
input: ftps://host5/?key3=value3
! failed to parse!
input: https://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: https://host2?key2=value3
! failed to parse!
input: ftps://host1/folder
! failed to parse!
input: http://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftp://host1/folder/folder?key1=value3&key1=value4&key3=value1
! failed to parse!
input: ftp://host5?key1=value2&key2=value1&key4=value1
! failed to parse!
input: http://host4/folder?key3=value1
! failed to parse!
input: https://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: http://host1/folder/folder?key4=value3&key3=value4
! failed to parse!
input: ftp://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftps://host3/folder
! failed to parse!
input: https://host2/folder/folder/?key4=value1&key2=value3&key1=value3
! failed to parse!
input: ftps://host3/folder
! failed to parse!
input: ftps://host2?key1=value4&key3=value2
! failed to parse!
input: ftp://host5/folder
! failed to parse!
input: http://host2/folder?key2=value1
! failed to parse!
input: http://host3/folder/folder/
! failed to parse!
input: ftps://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: ftp://host5/folder/?key1=value3
! failed to parse!
input: ftps://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftp://host4/?key1=value4&key1=value1&key2=value2&key2=value3
! failed to parse!
input: https://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftps://host4/folder/folder?key1=value1&key1=value3&key3=value4
! failed to parse!
input: http://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: ftps://host2/?key1=value3&key1=value4&key4=value3
! failed to parse!
input: ftp://host5/folder/folder/folder?key1=value2
! failed to parse!
input: ftps://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftp://host5/folder?key4=value4&key1=value2&key4=value4&key1=value3&key4=value4
! failed to parse!
input: ftp://host2/folder
! failed to parse!
input: ftp://host5/folder
! failed to parse!
input: ftp://host2/folder/?key1=value2
! failed to parse!
input: https://host2/folder
! failed to parse!
input: https://host2/folder?key2=value4
! failed to parse!
input: http://host4/folder
! failed to parse!
input: http://host5/folder/
! failed to parse!
input: ftp://host5/folder?key1=value2&key3=value3
! failed to parse!
input: ftps://host3?key2=value4&key4=value4&key3=value2&key2=value3
! failed to parse!
input: http://host5/folder?key1=value2
! failed to parse!
input: https://host4/folder?key1=value3&key3=value1
! failed to parse!
input: http://host3?key4=value4&key3=value1&key2=value2&key2=value1&key2=value4
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	3
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	1
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	2
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	2
                                                                          printables
                                                                            printable	&
                                                                            printables
                                                                              printable	k
                                                                              printables
                                                                                printable	e
                                                                                printables
                                                                                  printable	y
                                                                                  printables
                                                                                    printable	2
                                                                                    printables
                                                                                      printable	=
                                                                                      printables
                                                                                        printable	v
                                                                                        printables
                                                                                          printable	a
                                                                                          printables
                                                                                            printable	l
                                                                                            printables
                                                                                              printable	u
                                                                                              printables
                                                                                                printable	e
                                                                                                printables
                                                                                                  printable	1
                                                                                                  printables
                                                                                                    printable	&
                                                                                                    printables
                                                                                                      printable	k
                                                                                                      printables
                                                                                                        printable	e
                                                                                                        printables
                                                                                                          printable	y
                                                                                                          printables
                                                                                                            printable	2
                                                                                                            printables
                                                                                                              printable	=
                                                                                                              printables
                                                                                                                printable	v
                                                                                                                printables
                                                                                                                  printable	a
                                                                                                                  printables
                                                                                                                    printable	l
                                                                                                                    printables
                                                                                                                      printable	u
                                                                                                                      printables
                                                                                                                        printable	e
                                                                                                                        printables
                                                                                                                          printable	4
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	3
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	1
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	2
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	2
                                                                          printables
                                                                            printable	&
                                                                            printables
                                                                              printable	k
                                                                              printables
                                                                                printable	e
                                                                                printables
                                                                                  printable	y
                                                                                  printables
                                                                                    printable	2
                                                                                    printables
                                                                                      printable	=
                                                                                      printables
                                                                                        printable	v
                                                                                        printables
                                                                                          printable	a
                                                                                          printables
                                                                                            printable	l
                                                                                            printables
                                                                                              printable	u
                                                                                              printables
                                                                                                printable	e
                                                                                                printables
                                                                                                  printable	1
                                                                                                  printables
                                                                                                    printable	&
                                                                                                    printables
                                                                                                      printable	k
                                                                                                      printables
                                                                                                        printable	e
                                                                                                        printables
                                                                                                          printable	y
                                                                                                          printables
                                                                                                            printable	2
                                                                                                            printables
                                                                                                              printable	=
                                                                                                              printables
                                                                                                                printable	v
                                                                                                                printables
                                                                                                                  printable	a
                                                                                                                  printables
                                                                                                                    printable	l
                                                                                                                    printables
                                                                                                                      printable	u
                                                                                                                      printables
                                                                                                                        printable	e
                                                                                                                        printables
                                                                                                                          printable	4

input: https://host3/?key4=value4
! failed to parse!
input: ftps://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftps://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftp://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: http://host5/?key1=value1&key2=value4&key3=value4&key2=value4&key4=value1
! failed to parse!
input: ftps://host4/folder
! failed to parse!
input: http://host1?key3=value2
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2

input: ftp://host4/folder/
! failed to parse!
input: http://host1/folder
! failed to parse!
input: http://host4/folder?key2=value2
! failed to parse!
input: http://host1/folder?key1=value2&key1=value2&key4=value4
! failed to parse!
input: http://host5/folder?key1=value1&key4=value1
! failed to parse!
input: https://host1?key3=value2
! failed to parse!
input: ftp://host5/?key1=value2
! failed to parse!
input: ftp://host1/?key3=value1
! failed to parse!
input: http://host1/folder
! failed to parse!
input: https://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftps://host4/folder/
! failed to parse!
input: https://host1/folder
! failed to parse!
input: https://host2/folder?key1=value4&key4=value3
! failed to parse!
input: https://host5/folder?key4=value2
! failed to parse!
input: https://host2/folder?key1=value4&key4=value1
! failed to parse!
input: https://host2?key2=value4
! failed to parse!
input: https://host4/folder?key1=value1&key1=value4
! failed to parse!
input: http://host4/folder?key1=value4
! failed to parse!
input: ftps://host2/?key1=value1
! failed to parse!
input: https://host4?key1=value1
! failed to parse!
input: ftp://host5?key1=value2
! failed to parse!
input: http://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: ftps://host4?key3=value1
! failed to parse!
input: ftp://host5/folder
! failed to parse!
input: ftps://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: ftps://host5/folder/
! failed to parse!
input: ftps://host2/folder/folder
! failed to parse!
input: ftps://host4/folder?key1=value1&key2=value1
! failed to parse!
input: https://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftp://host2/?key4=value3
! failed to parse!
input: http://host5/folder/?key1=value3
! failed to parse!
input: ftp://host2?key4=value2&key2=value2
! failed to parse!
input: http://host5/folder
! failed to parse!
input: https://host4?key3=value1&key2=value2
! failed to parse!
input: ftp://host3/folder
! failed to parse!
input: ftp://host1/?key1=value4&key3=value4
! failed to parse!
input: ftp://host5/folder
! failed to parse!
input: ftp://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: https://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftps://host4/folder/folder?key3=value2&key1=value2&key4=value2&key4=value3&key4=value4
! failed to parse!
input: ftp://host4/?key2=value3&key3=value3&key1=value4&key3=value1
! failed to parse!
input: http://host3/folder?key1=value2&key2=value1
! failed to parse!
input: ftps://host5/folder
! failed to parse!
input: http://host3?key1=value1
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	1

input: ftp://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: http://host3/?key2=value2
! failed to parse!
input: http://host2/folder/folder?key2=value2
! failed to parse!
input: ftps://host4/?key4=value3
! failed to parse!
input: http://host4/folder
! failed to parse!
input: ftp://host2/folder/?key3=value2&key3=value1&key1=value3
! failed to parse!
input: http://host3?key4=value2&key3=value2
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	3
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	3
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	2

input: http://host3/folder
! failed to parse!
input: https://host1/folder?key4=value2
! failed to parse!
input: https://host1/folder/?key3=value4&key1=value3
! failed to parse!
input: ftp://host2/folder/
! failed to parse!
input: ftps://host1/folder
! failed to parse!
input: ftps://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: http://host1/folder
! failed to parse!
input: https://host5/folder/folder/folder
! failed to parse!
input: ftps://host4/?key3=value4
! failed to parse!
input: ftp://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: http://host5/?key2=value2&key2=value2
! failed to parse!
input: ftp://host1/folder
! failed to parse!
input: https://host5/folder?key3=value4&key2=value4&key3=value2&key3=value1
! failed to parse!
input: http://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: https://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: http://host3?key1=value4&key4=value3
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	4
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	4
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	3

input: http://host5/?key4=value4&key4=value2
! failed to parse!
input: https://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: http://host1/folder?key4=value4
! failed to parse!
input: ftps://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftps://host3/folder?key4=value3
! failed to parse!
input: ftps://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: http://host5?key2=value4&key1=value1
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	1
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	1
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	1

input: ftp://host3?key3=value4
! failed to parse!
input: https://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: https://host2/folder?key1=value4
! failed to parse!
input: https://host2/folder?key4=value4
! failed to parse!
input: http://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftps://host3/folder
! failed to parse!
input: https://host3/folder
! failed to parse!
input: ftp://host4?key2=value3&key1=value2&key4=value2&key1=value3&key1=value3&key3=value4&key2=value3
! failed to parse!
input: ftp://host1/folder?key3=value4
! failed to parse!
input: https://host3?key4=value3&key1=value1
! failed to parse!
input: ftp://host4/folder?key4=value4&key1=value1
! failed to parse!
input: http://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: http://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftps://host4/?key2=value4&key3=value4&key3=value1&key2=value4&key3=value3&key4=value2&key2=value4
! failed to parse!
input: http://host3/?key4=value4&key4=value3
! failed to parse!
input: https://host5/?key3=value3
! failed to parse!
input: ftps://host4/folder?key3=value2
! failed to parse!
input: https://host2/folder/
! failed to parse!
input: ftp://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: https://host1/folder?key2=value2&key1=value3&key1=value3
! failed to parse!
input: http://host4/folder
! failed to parse!
input: https://host1/folder?key1=value4&key1=value4&key3=value3&key3=value4&key1=value4
! failed to parse!
input: ftps://host4/folder
! failed to parse!
input: https://host2?key1=value3&key2=value1
! failed to parse!
input: http://host3/?key2=value4
! failed to parse!
input: ftp://host2/?key2=value4
! failed to parse!
input: https://host5/folder/folder
! failed to parse!
input: https://host4/folder
! failed to parse!
input: http://host4/?key2=value1
! failed to parse!
input: http://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: https://host5/folder/folder/folder/folder?key1=value1&key4=value2&key3=value2&key3=value2&key3=value3&key4=value1&key2=value1&key1=value1
! failed to parse!
input: ftp://host5?key4=value3&key4=value2
! failed to parse!
input: http://host2/folder/folder?key2=value4&key2=value3&key4=value2
! failed to parse!
input: ftp://host5?key3=value1&key1=value4&key4=value1&key3=value2
! failed to parse!
input: https://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: https://host1/?key4=value1&key4=value3&key3=value1
! failed to parse!
input: http://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: http://host5?key2=value2&key2=value2&key2=value3
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	2
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	2
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	2
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	2
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	2
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	2
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	3

input: ftp://host4/folder/
! failed to parse!
input: ftps://host5/folder/folder?key3=value1&key4=value4&key3=value2&key3=value4
! failed to parse!
input: https://host1/folder
! failed to parse!
input: https://host5/folder
! failed to parse!
input: ftps://host1/folder?key2=value3&key4=value3&key2=value4&key2=value4
! failed to parse!
input: ftp://host4?key2=value3&key2=value3&key1=value4&key3=value1&key4=value4
! failed to parse!
input: http://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftps://host5/?key4=value3&key1=value2
! failed to parse!
input: http://host5/folder
! failed to parse!
input: ftp://host4/?key1=value4
! failed to parse!
input: ftps://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: https://host3/folder?key3=value2
! failed to parse!
input: https://host4/?key2=value3
! failed to parse!
input: https://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: https://host1/folder/folder
! failed to parse!
input: ftp://host1/folder?key4=value1
! failed to parse!
input: http://host2/folder?key1=value2
! failed to parse!
input: https://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftp://host2/folder
! failed to parse!
input: http://host1/folder
! failed to parse!
input: http://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: http://host5/folder
! failed to parse!
input: ftp://host4/folder/folder
! failed to parse!
input: https://host2/folder/folder/folder/
! failed to parse!
input: ftp://host3/?key2=value4
! failed to parse!
input: ftp://host3/folder
! failed to parse!
input: ftp://host5?key4=value3
! failed to parse!
input: ftps://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: http://host5/folder/
! failed to parse!
input: https://host4/folder?key1=value3&key2=value4&key4=value1
! failed to parse!
input: ftps://host4/folder/folder?key1=value4&key2=value1
! failed to parse!
input: https://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: https://host3/folder/folder?key1=value2
! failed to parse!
input: ftps://host1/?key2=value4
! failed to parse!
input: ftps://host4/folder
! failed to parse!
input: https://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftp://host2?key1=value1
! failed to parse!
input: ftp://host2/folder?key3=value2&key4=value4
! failed to parse!
input: ftps://host4/?key1=value4
! failed to parse!
input: https://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftp://host2/folder?key2=value3
! failed to parse!
input: http://host1/folder/folder/folder?key3=value1&key3=value1
! failed to parse!
input: ftps://host4/folder?key2=value2&key3=value4
! failed to parse!
input: ftps://host4/folder
! failed to parse!
input: https://host1/folder
! failed to parse!
input: ftp://host5/folder/folder?key1=value1&key2=value3
! failed to parse!
input: https://host1/folder
! failed to parse!
input: ftp://host1/folder/folder?key4=value4&key3=value2&key3=value4&key1=value1&key2=value4
! failed to parse!
input: http://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftps://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftps://host5/folder?key1=value1
! failed to parse!
input: ftps://host2/folder/?key3=value2
! failed to parse!
input: ftps://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: ftp://host2/folder/folder/folder?key4=value3&key4=value2
! failed to parse!
input: ftp://host1/folder?key3=value3
! failed to parse!
input: ftps://host5/folder/folder/folder/?key1=value2
! failed to parse!
input: https://host5?key4=value1&key2=value4
! failed to parse!
input: http://host1/folder
! failed to parse!
input: https://host1/folder/folder
! failed to parse!
input: ftp://host1/?key3=value3&key2=value4
! failed to parse!
input: https://host2/folder?key3=value3
! failed to parse!
input: http://host3/folder/folder?key3=value3
! failed to parse!
input: https://host3/folder
! failed to parse!
input: ftps://host4/folder/folder?key3=value1
! failed to parse!
input: ftps://host3/folder
! failed to parse!
input: http://host5/folder
! failed to parse!
input: ftp://host4/folder
! failed to parse!
input: ftps://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftps://host3/folder
! failed to parse!
input: http://host3/folder/folder/folder/folder?key1=value2&key3=value1&key4=value3
! failed to parse!
input: https://host2/folder?key3=value4&key4=value4&key4=value4&key4=value4
! failed to parse!
input: ftp://host1/?key1=value4&key1=value2&key3=value1&key4=value2
! failed to parse!
input: ftps://host1/folder
! failed to parse!
input: ftps://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: http://host2/folder/?key4=value4
! failed to parse!
input: ftps://host3/folder/folder/folder/
! failed to parse!
input: ftps://host1/folder
! failed to parse!
input: ftps://host5/folder?key4=value4
! failed to parse!
input: https://host5/folder
! failed to parse!
input: http://host2/folder/folder?key1=value1
! failed to parse!
input: ftp://host5/?key1=value3&key1=value1&key3=value4&key2=value4&key3=value2&key2=value3
! failed to parse!
input: http://host1/folder
! failed to parse!
input: https://host3/?key1=value1
! failed to parse!
input: http://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: https://host1/?key3=value3&key2=value1
! failed to parse!
input: ftp://host2?key2=value3&key3=value3
! failed to parse!
input: https://host1/folder?key1=value4&key3=value3
! failed to parse!
input: https://host3/folder?key3=value2
! failed to parse!
input: https://host1/folder?key4=value2&key2=value2
! failed to parse!
input: ftp://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftp://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: https://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftps://host5/?key1=value4&key4=value1&key4=value2&key4=value3&key2=value3&key4=value1
! failed to parse!
input: http://host4/folder/folder?key3=value4&key4=value4&key3=value1&key2=value1
! failed to parse!
input: http://host3?key2=value3&key3=value1
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	3
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	3
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	1

input: ftps://host2/?key3=value3&key2=value3&key3=value3&key2=value4
! failed to parse!
input: http://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: http://host3/folder?key3=value4
! failed to parse!
input: https://host3/folder
! failed to parse!
input: ftps://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: http://host4/?key2=value2
! failed to parse!
input: https://host2/folder
! failed to parse!
input: ftps://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: ftp://host4/folder/folder/folder
! failed to parse!
input: ftp://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: https://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: ftps://host2?key4=value4&key3=value3
! failed to parse!
input: ftp://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: http://host2/folder
! failed to parse!
input: http://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftps://host2/folder
! failed to parse!
input: http://host2/folder?key3=value4
! failed to parse!
input: ftp://host5/folder/folder/folder
! failed to parse!
input: http://host1?key2=value1&key1=value3&key2=value3
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	1
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	1
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	3
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	2
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	1
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	1
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	3
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	2
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	3

input: https://host4?key1=value4&key1=value1&key2=value1&key1=value3
! failed to parse!
input: ftp://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftp://host4/folder
! failed to parse!
input: ftps://host2/folder?key1=value1
! failed to parse!
input: ftp://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: ftps://host4/folder/?key4=value1
! failed to parse!
input: ftp://host1?key4=value2
! failed to parse!
input: ftps://host3/folder/
! failed to parse!
input: ftp://host2/folder?key2=value2
! failed to parse!
input: http://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: https://host1?key2=value3
! failed to parse!
input: ftp://host4/folder
! failed to parse!
input: ftps://host5/folder
! failed to parse!
input: ftp://host5/folder/?key1=value2
! failed to parse!
input: http://host2?key2=value2
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2

input: http://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: https://host3/folder
! failed to parse!
input: ftps://host2?key2=value4
! failed to parse!
input: https://host3/folder?key4=value4
! failed to parse!
input: http://host2?key4=value3
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3

input: https://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: http://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftps://host5/folder
! failed to parse!
input: ftps://host4/folder
! failed to parse!
input: http://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftp://host2?key3=value4
! failed to parse!
input: http://host3/folder?key1=value1
! failed to parse!
input: https://host1/folder?key4=value1&key4=value1&key1=value1
! failed to parse!
input: https://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftp://host5/folder?key4=value3
! failed to parse!
input: https://host4/folder
! failed to parse!
input: https://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: https://host4/folder/folder?key1=value4
! failed to parse!
input: ftps://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftps://host4/folder?key2=value1
! failed to parse!
input: ftp://host4/folder/folder/?key4=value4&key4=value2&key2=value2
! failed to parse!
input: http://host1?key3=value1
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	1

input: https://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: https://host4/folder/folder/folder/
! failed to parse!
input: ftps://host4/folder
! failed to parse!
input: http://host5/folder
! failed to parse!
input: ftps://host1/?key3=value1
! failed to parse!
input: ftps://host4/folder/folder?key1=value4
! failed to parse!
input: http://host5/folder/folder?key2=value2
! failed to parse!
input: ftp://host2/folder?key1=value4
! failed to parse!
input: https://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: http://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: http://host4/folder
! failed to parse!
input: ftp://host5/folder
! failed to parse!
input: https://host4/folder
! failed to parse!
input: https://host3/folder/?key4=value3
! failed to parse!
input: http://host4/folder
! failed to parse!
input: http://host5/?key2=value2
! failed to parse!
input: https://host4/folder
! failed to parse!
input: http://host1?key1=value2&key2=value4&key1=value3&key1=value3
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	2
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	4
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	1
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	3
                                                                          printables
                                                                            printable	&
                                                                            printables
                                                                              printable	k
                                                                              printables
                                                                                printable	e
                                                                                printables
                                                                                  printable	y
                                                                                  printables
                                                                                    printable	1
                                                                                    printables
                                                                                      printable	=
                                                                                      printables
                                                                                        printable	v
                                                                                        printables
                                                                                          printable	a
                                                                                          printables
                                                                                            printable	l
                                                                                            printables
                                                                                              printable	u
                                                                                              printables
                                                                                                printable	e
                                                                                                printables
                                                                                                  printable	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	2
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	4
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	1
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	3
                                                                          printables
                                                                            printable	&
                                                                            printables
                                                                              printable	k
                                                                              printables
                                                                                printable	e
                                                                                printables
                                                                                  printable	y
                                                                                  printables
                                                                                    printable	1
                                                                                    printables
                                                                                      printable	=
                                                                                      printables
                                                                                        printable	v
                                                                                        printables
                                                                                          printable	a
                                                                                          printables
                                                                                            printable	l
                                                                                            printables
                                                                                              printable	u
                                                                                              printables
                                                                                                printable	e
                                                                                                printables
                                                                                                  printable	3

input: ftps://host4/folder/?key4=value1
! failed to parse!
input: ftps://host1/folder/folder/folder
! failed to parse!
input: ftp://host3?key3=value4&key1=value3
! failed to parse!
input: https://host1/folder
! failed to parse!
input: ftps://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: https://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftps://host2/folder
! failed to parse!
input: https://host3/folder
! failed to parse!
input: https://host1/folder/folder
! failed to parse!
input: ftp://host4/folder?key2=value4
! failed to parse!
input: ftps://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: http://host3/folder/folder
! failed to parse!
input: ftp://host4?key2=value3
! failed to parse!
input: http://host2/folder/folder/
! failed to parse!
input: http://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: https://host3/folder/folder?key4=value4
! failed to parse!
input: ftps://host4/folder
! failed to parse!
input: ftps://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: https://host1/folder/
! failed to parse!
input: ftps://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: http://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftp://host2?key2=value2&key1=value4&key4=value2&key1=value4&key2=value4&key1=value2&key3=value2
! failed to parse!
input: ftp://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftps://host1/folder?key4=value1
! failed to parse!
input: ftps://host2?key2=value3
! failed to parse!
input: ftp://host4/folder/folder?key4=value4&key1=value2&key3=value2
! failed to parse!
input: ftps://host4?key1=value1&key3=value3
! failed to parse!
input: http://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: http://host2?key4=value3&key3=value2&key4=value1
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	3
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	2
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	4
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	3
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	2
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	4
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	1

input: ftps://host5/folder?key1=value1&key3=value1
! failed to parse!
input: http://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftp://host1/?key3=value2
! failed to parse!
input: ftp://host5/folder/folder?key3=value1&key2=value3&key3=value1
! failed to parse!
input: https://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftp://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: https://host4?key1=value3&key2=value2
! failed to parse!
input: https://host4/folder?key2=value3&key3=value4
! failed to parse!
input: ftps://host3/folder?key4=value4
! failed to parse!
input: https://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: https://host2?key1=value1&key4=value3
! failed to parse!
input: http://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftps://host2/folder?key1=value2&key4=value3&key3=value1&key2=value4&key2=value2
! failed to parse!
input: http://host3/folder
! failed to parse!
input: http://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: https://host2/folder/folder?key4=value1
! failed to parse!
input: ftps://host5/folder?key1=value1&key4=value2&key4=value2
! failed to parse!
input: ftp://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: http://host1/folder/
! failed to parse!
input: ftp://host1/folder?key1=value3&key1=value2
! failed to parse!
input: https://host1/folder?key3=value1
! failed to parse!
input: https://host1/folder?key4=value3&key1=value4
! failed to parse!
input: https://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftp://host3/folder?key3=value2&key3=value3
! failed to parse!
input: https://host5/folder?key2=value2
! failed to parse!
input: https://host3/folder
! failed to parse!
input: ftp://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: http://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: ftp://host4/folder/folder/
! failed to parse!
input: http://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: https://host4/folder
! failed to parse!
input: https://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: ftps://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftp://host2/folder?key2=value2
! failed to parse!
input: ftps://host4?key2=value1
! failed to parse!
input: https://host5/folder/
! failed to parse!
input: ftps://host2/?key1=value4&key1=value2
! failed to parse!
input: ftps://host5/folder
! failed to parse!
input: https://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: http://host1/folder/folder
! failed to parse!
input: ftp://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: http://host2/folder?key2=value2
! failed to parse!
input: ftps://host4/folder
! failed to parse!
input: ftp://host3/?key3=value4&key2=value1
! failed to parse!
input: ftps://host3/folder?key4=value2
! failed to parse!
input: ftp://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: http://host3/folder
! failed to parse!
input: https://host1/folder?key4=value4&key1=value3&key3=value4&key1=value1&key4=value2
! failed to parse!
input: ftp://host3/folder?key3=value4&key2=value3
! failed to parse!
input: ftp://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: http://host2?key2=value3&key1=value4
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	1
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	4
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	3
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	1
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	4

input: http://host2/folder/?key2=value4&key2=value1&key2=value1&key1=value2&key3=value3
! failed to parse!
input: http://host5/folder/?key4=value2
! failed to parse!
input: http://host4/folder?key2=value4
! failed to parse!
input: https://host4/folder/folder/?key4=value1&key3=value1&key1=value1
! failed to parse!
input: http://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftp://host3/folder?key1=value3
! failed to parse!
input: http://host4/folder?key4=value2
! failed to parse!
input: ftp://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftps://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: https://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftps://host4/folder
! failed to parse!
input: http://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: https://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: http://host2/?key2=value4&key4=value2&key4=value4
! failed to parse!
input: ftps://host4/folder/folder
! failed to parse!
input: ftp://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftp://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: http://host2?key3=value2
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2

input: http://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: https://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftp://host5/?key1=value3
! failed to parse!
input: https://host1/?key1=value2
! failed to parse!
input: http://host3?key2=value2&key4=value3&key2=value4&key1=value3&key2=value3&key2=value1
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	4
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	3
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	2
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	4
                                                                          printables
                                                                            printable	&
                                                                            printables
                                                                              printable	k
                                                                              printables
                                                                                printable	e
                                                                                printables
                                                                                  printable	y
                                                                                  printables
                                                                                    printable	1
                                                                                    printables
                                                                                      printable	=
                                                                                      printables
                                                                                        printable	v
                                                                                        printables
                                                                                          printable	a
                                                                                          printables
                                                                                            printable	l
                                                                                            printables
                                                                                              printable	u
                                                                                              printables
                                                                                                printable	e
                                                                                                printables
                                                                                                  printable	3
                                                                                                  printables
                                                                                                    printable	&
                                                                                                    printables
                                                                                                      printable	k
                                                                                                      printables
                                                                                                        printable	e
                                                                                                        printables
                                                                                                          printable	y
                                                                                                          printables
                                                                                                            printable	2
                                                                                                            printables
                                                                                                              printable	=
                                                                                                              printables
                                                                                                                printable	v
                                                                                                                printables
                                                                                                                  printable	a
                                                                                                                  printables
                                                                                                                    printable	l
                                                                                                                    printables
                                                                                                                      printable	u
                                                                                                                      printables
                                                                                                                        printable	e
                                                                                                                        printables
                                                                                                                          printable	3
                                                                                                                          printables
                                                                                                                            printable	&
                                                                                                                            printables
                                                                                                                              printable	k
                                                                                                                              printables
                                                                                                                                printable	e
                                                                                                                                printables
                                                                                                                                  printable	y
                                                                                                                                  printables
                                                                                                                                    printable	2
                                                                                                                                    printables
                                                                                                                                      printable	=
                                                                                                                                      printables
                                                                                                                                        printable	v
                                                                                                                                        printables
                                                                                                                                          printable	a
                                                                                                                                          printables
                                                                                                                                            printable	l
                                                                                                                                            printables
                                                                                                                                              printable	u
                                                                                                                                              printables
                                                                                                                                                printable	e
                                                                                                                                                printables
                                                                                                                                                  printable	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	2
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	4
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	3
                                                  printables
                                                    printable	&
                                                    printables
                                                      printable	k
                                                      printables
                                                        printable	e
                                                        printables
                                                          printable	y
                                                          printables
                                                            printable	2
                                                            printables
                                                              printable	=
                                                              printables
                                                                printable	v
                                                                printables
                                                                  printable	a
                                                                  printables
                                                                    printable	l
                                                                    printables
                                                                      printable	u
                                                                      printables
                                                                        printable	e
                                                                        printables
                                                                          printable	4
                                                                          printables
                                                                            printable	&
                                                                            printables
                                                                              printable	k
                                                                              printables
                                                                                printable	e
                                                                                printables
                                                                                  printable	y
                                                                                  printables
                                                                                    printable	1
                                                                                    printables
                                                                                      printable	=
                                                                                      printables
                                                                                        printable	v
                                                                                        printables
                                                                                          printable	a
                                                                                          printables
                                                                                            printable	l
                                                                                            printables
                                                                                              printable	u
                                                                                              printables
                                                                                                printable	e
                                                                                                printables
                                                                                                  printable	3
                                                                                                  printables
                                                                                                    printable	&
                                                                                                    printables
                                                                                                      printable	k
                                                                                                      printables
                                                                                                        printable	e
                                                                                                        printables
                                                                                                          printable	y
                                                                                                          printables
                                                                                                            printable	2
                                                                                                            printables
                                                                                                              printable	=
                                                                                                              printables
                                                                                                                printable	v
                                                                                                                printables
                                                                                                                  printable	a
                                                                                                                  printables
                                                                                                                    printable	l
                                                                                                                    printables
                                                                                                                      printable	u
                                                                                                                      printables
                                                                                                                        printable	e
                                                                                                                        printables
                                                                                                                          printable	3
                                                                                                                          printables
                                                                                                                            printable	&
                                                                                                                            printables
                                                                                                                              printable	k
                                                                                                                              printables
                                                                                                                                printable	e
                                                                                                                                printables
                                                                                                                                  printable	y
                                                                                                                                  printables
                                                                                                                                    printable	2
                                                                                                                                    printables
                                                                                                                                      printable	=
                                                                                                                                      printables
                                                                                                                                        printable	v
                                                                                                                                        printables
                                                                                                                                          printable	a
                                                                                                                                          printables
                                                                                                                                            printable	l
                                                                                                                                            printables
                                                                                                                                              printable	u
                                                                                                                                              printables
                                                                                                                                                printable	e
                                                                                                                                                printables
                                                                                                                                                  printable	1

input: ftps://host1/folder?key2=value4&key2=value3&key3=value3&key4=value2&key4=value4
! failed to parse!
input: http://host2/folder
! failed to parse!
input: ftps://host1?key3=value2&key2=value4
! failed to parse!
input: ftps://host3/folder?key4=value3&key1=value1&key3=value4
! failed to parse!
input: ftp://host3?key3=value2
! failed to parse!
input: https://host3/folder/?key3=value2
! failed to parse!
input: ftps://host4/?key3=value1&key4=value3
! failed to parse!
input: ftp://host2/folder?key4=value4
! failed to parse!
input: https://host1/folder?key4=value2&key1=value2
! failed to parse!
input: ftps://host2/folder
! failed to parse!
input: http://host1?key3=value2
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2

input: https://host4?key2=value4
! failed to parse!
input: http://host5/folder?key2=value4&key3=value3
! failed to parse!
input: http://host1/folder/folder
! failed to parse!
input: https://host2/folder?key2=value4&key2=value3&key2=value1&key1=value1&key3=value4&key3=value1
! failed to parse!
input: https://host2/folder?key4=value4&key2=value1
! failed to parse!
input: http://host4/folder
! failed to parse!
input: ftps://host5/folder?key1=value1&key1=value2&key4=value3
! failed to parse!
input: ftp://host5?key1=value4&key1=value1
! failed to parse!
input: https://host4/folder
! failed to parse!
input: http://host5/folder/
! failed to parse!
input: ftp://host4/folder/
! failed to parse!
input: http://host2?key3=value2
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	3
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2

input: ftp://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: http://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: http://host4/folder/folder
! failed to parse!
input: ftp://host5/folder/folder/?key2=value1&key4=value3&key3=value3
! failed to parse!
input: http://host4/folder
! failed to parse!
input: ftps://host5/?key3=value1&key3=value2
! failed to parse!
input: ftps://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftps://host4/folder?key4=value1&key3=value2&key3=value2
! failed to parse!
input: https://host5?key1=value4&key1=value4
! failed to parse!
input: ftps://host1/folder/folder?key1=value2&key2=value3
! failed to parse!
input: ftps://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: https://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftps://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: ftp://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: ftp://host3?key2=value3&key1=value1&key1=value2&key1=value1&key3=value1
! failed to parse!
input: https://host1/folder/folder
! failed to parse!
input: http://host1/folder/folder?key4=value2&key1=value2
! failed to parse!
input: http://host1/?key2=value1&key4=value4&key4=value3&key3=value1
! failed to parse!
input: ftp://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: ftps://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftps://host3?key2=value1&key3=value2
! failed to parse!
input: ftp://host4/folder
! failed to parse!
input: ftp://host3/?key4=value1
! failed to parse!
input: ftps://host3/folder/folder/folder/?key3=value2&key4=value4
! failed to parse!
input: ftp://host5/folder?key1=value2
! failed to parse!
input: https://host1/folder/folder?key1=value1&key4=value4&key1=value1
! failed to parse!
input: https://host1/folder?key2=value3
! failed to parse!
input: ftps://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: https://host3?key4=value2&key3=value4&key3=value3&key3=value2
! failed to parse!
input: http://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: http://host4/folder/
! failed to parse!
input: ftps://host2/?key4=value2
! failed to parse!
input: https://host3?key2=value2
! failed to parse!
input: http://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftp://host2?key2=value2
! failed to parse!
input: ftps://host2/folder/?key2=value1
! failed to parse!
input: ftps://host1/folder/folder
! failed to parse!
input: https://host1/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
    /

input: http://host1/folder
! failed to parse!
input: https://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: ftps://host5/folder
! failed to parse!
input: http://host2/folder
! failed to parse!
input: ftps://host2/?key2=value1&key2=value4
! failed to parse!
input: http://host1/folder?key1=value3&key2=value3&key3=value3&key1=value3
! failed to parse!
input: ftps://host4/?key2=value4
! failed to parse!
input: https://host1?key3=value3
! failed to parse!
input: ftp://host4/?key2=value4
! failed to parse!
input: http://host1/?key2=value1
! failed to parse!
input: https://host3/folder?key4=value4&key1=value3
! failed to parse!
input: https://host1/folder/?key2=value3&key3=value2&key1=value2
! failed to parse!
input: https://host5/folder
! failed to parse!
input: ftps://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: http://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: ftp://host5?key3=value2
! failed to parse!
input: http://host3/folder/folder/folder
! failed to parse!
input: ftp://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: https://host1/?key1=value3&key2=value2
! failed to parse!
input: ftp://host4/folder/folder
! failed to parse!
input: http://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: ftps://host2/?key1=value4
! failed to parse!
input: http://host3/folder
! failed to parse!
input: https://host1/folder?key1=value3
! failed to parse!
input: https://host1/?key3=value1
! failed to parse!
input: http://host4/folder
! failed to parse!
input: http://host4/folder/folder?key3=value2&key4=value1
! failed to parse!
input: https://host1/folder/folder?key1=value1&key2=value3
! failed to parse!
input: https://host3/folder/folder
! failed to parse!
input: https://host2?key1=value2&key4=value1
! failed to parse!
input: ftps://host4/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    /

input: ftp://host2
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2

input: ftps://host4
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4

input: https://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: https://host1/folder/
! failed to parse!
input: http://host3/folder?key1=value2&key3=value4&key4=value3
! failed to parse!
input: http://host4?key1=value4&key4=value1
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	4
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	1
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	1
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	4
                          printables
                            printable	&
                            printables
                              printable	k
                              printables
                                printable	e
                                printables
                                  printable	y
                                  printables
                                    printable	4
                                    printables
                                      printable	=
                                      printables
                                        printable	v
                                        printables
                                          printable	a
                                          printables
                                            printable	l
                                            printables
                                              printable	u
                                              printables
                                                printable	e
                                                printables
                                                  printable	1

input: https://host1?key4=value1
! failed to parse!
input: https://host3/folder?key3=value4&key1=value1
! failed to parse!
input: ftps://host3/folder
! failed to parse!
input: https://host2?key4=value3
! failed to parse!
input: http://host1/folder?key4=value1&key3=value2&key1=value4&key2=value4
! failed to parse!
input: ftps://host2/folder/folder/folder/
! failed to parse!
input: ftps://host5/folder?key4=value3
! failed to parse!
input: http://host4?key4=value2
output:
_ambig
  start
    http://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	4
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2
  start
    http://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	4
    ?
    printables
      printable	k
      printables
        printable	e
        printables
          printable	y
          printables
            printable	4
            printables
              printable	=
              printables
                printable	v
                printables
                  printable	a
                  printables
                    printable	l
                    printables
                      printable	u
                      printables
                        printable	e
                        printables
                          printable	2

input: ftps://host1
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	1
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	1

input: https://host1/folder/folder?key4=value3&key2=value4
! failed to parse!
input: ftp://host4/folder
! failed to parse!
input: ftp://host1/?key1=value4
! failed to parse!
input: ftps://host5
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5

input: ftps://host4/folder/folder
! failed to parse!
input: ftps://host5/folder?key4=value4
! failed to parse!
input: https://host3
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3

input: https://host5/folder
! failed to parse!
input: https://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	t
          alphanumerics
            alphanumeric	p
            alphanumerics
              alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	h
      letters
        letter	t
        letters
          letter	t
          letters
            letter	p
            letters
              letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	h
          letters
            letter	t
            letters
              letter	t
              letters
                letter	p
                letters
                  letter	s
      start
        alphanumerics
          alphanumeric	h
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	p
                alphanumerics
                  alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: ftps://host1/folder
! failed to parse!
input: ftps://host2/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
          alphanumerics
            alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
          letters
            letter	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	2
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
              letters
                letter	s
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
              alphanumerics
                alphanumeric	s
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	2
    /

input: ftp://host5/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	5
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	5
    /

input: ftp://host5/?key2=value4
! failed to parse!
input: https://host3/?key3=value1&key4=value1&key1=value3&key1=value4
! failed to parse!
input: ftp://host3/
output:
_ambig
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    alphanumerics
      alphanumeric	f
      alphanumerics
        alphanumeric	t
        alphanumerics
          alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    letters
      letter	f
      letters
        letter	t
        letters
          letter	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    alphanumerics
      alphanumeric	h
      alphanumerics
        alphanumeric	o
        alphanumerics
          alphanumeric	s
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	3
    /
  start
    _ambig
      start
        letters
          letter	f
          letters
            letter	t
            letters
              letter	p
      start
        alphanumerics
          alphanumeric	f
          alphanumerics
            alphanumeric	t
            alphanumerics
              alphanumeric	p
    ://
    start
      alphanumerics
        alphanumeric	h
        alphanumerics
          alphanumeric	o
          alphanumerics
            alphanumeric	s
            alphanumerics
              alphanumeric	t
              alphanumerics
                alphanumeric	3
    /

input: ftps://host5/folder/folder/folder/?key1=value4
! failed to parse!
input: ftp://host3/folder?key3=value2
! failed to parse!
input: ftp://host4?key2=value3&key2=value3
! failed to parse!
input: ftps://host2?key3=value3
! failed to parse!
benchmark: urlparse recall: 296/1000=0.296, precision: 100/100=1.0